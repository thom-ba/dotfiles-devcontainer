#!/bin/bash
set -e

echo "ðŸš€ Starting custom environment setup..."

# 1. Install Homebrew (Non-interactive)
if ! command -v brew &> /dev/null; then
    echo "ðŸº Installing Homebrew..."
    NONINTERACTIVE=1 /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# 2. Install Tools via Brew
echo "ðŸ“¦ Installing CLI tools..."
brew install fd ripgrep lazygit starship neovim fluxcd/tap/flux

# 3. Setup Starship Prompt
echo 'eval "$(starship init bash)"' >> ~/.bashrc

# 4. Link Dotfiles (DevPod clones these to ~/dotfiles by default)
DOTFILES_DIR="$HOME/dotfiles"
if [ -d "$DOTFILES_DIR" ]; then
    echo "ðŸ”— Linking dotfiles from $DOTFILES_DIR..."
    ln -sf "$DOTFILES_DIR/nvim" "$HOME/.config/nvim"
    # Add any other links you need here
fi

echo "âœ… Setup complete!"
